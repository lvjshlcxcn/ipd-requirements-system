# 快速测试指南

## 当前状态
✅ 后端服务运行中（http://localhost:8000）
✅ 前端服务运行中（http://localhost:5173）
✅ 投票人员已设置：[2, 3]（市场产品经理、研发产品经理）

## 测试数据
- **会议ID**: 45
- **会议编号**: RM-20260204-003
- **需求ID**: 20
- **需求编号**: REQ-2026-0016
- **投票人员**:
  - ID 2: market_pm（市场产品经理）
  - ID 3: rd_pm（研发产品经理）

## 快速测试步骤

### 1. 打开浏览器
访问：http://localhost:5173

### 2. 登录系统
使用以下任一账号登录：
- 用户ID 2: market_pm
- 用户ID 3: rd_pm

### 3. 进入投票页面
1. 点击左侧菜单"评审中心"
2. 点击会议"RM-20260204-003"
3. 点击需求"REQ-2026-0016"

### 4. 查看投票人员面板（右侧）
应该看到：
- 进度条：0/2（0%）
- 市场产品经理 - 未投票
- 研发产品经理 - 未投票

### 5. 测试投票权限

#### 测试场景A：当前用户在投票人员列表中
**预期结果**：
- ✅ 可以看到投票选项（通过/拒绝/弃权）
- ✅ 可以提交投票
- ✅ 投票后状态变为"已投票"
- ✅ 投票后不能修改（选项变灰）

#### 测试场景B：当前用户不在投票人员列表中
**操作**：使用其他账号（如admin）登录
**预期结果**：
- ❌ 投票按钮应该禁用
- ❌ 或者点击后显示错误："您没有投票权限"

#### 测试场景C：已投票用户尝试再次投票
**操作**：已投票的用户再次点击投票
**预期结果**：
- ❌ 显示错误："您已经投过票了，不能修改投票选项"
- ❌ 投票选项变灰，不可修改

### 6. 查看投票进度
投票后，"投票人员"面板应该显示：
- 进度条：1/2（50%）或 2/2（100%）
- 已投票人员显示对应的投票选项和颜色

## API测试命令（可选）

### 获取投票人员状态
```bash
curl -s 'http://localhost:8000/api/v1/requirement-review-meetings/45/requirements/20/voters' | python3 -m json.tool
```

### 清空投票人员列表（用于测试"从空开始"场景）
```bash
curl -s -X PATCH 'http://localhost:8000/api/v1/requirement-review-meetings/45/requirements/20/voters' \
  -H 'Content-Type: application/json' \
  -d '{"assigned_voter_ids":[]}' | python3 -m json.tool
```

### 重置投票人员列表
```bash
curl -s -X PATCH 'http://localhost:8000/api/v1/requirement-review-meetings/45/requirements/20/voters' \
  -H 'Content-Type: application/json' \
  -d '{"assigned_voter_ids":[2,3]}' | python3 -m json.tool
```

## 关键功能验证清单

- [ ] 只有指定投票人员（ID 2, 3）可以投票
- [ ] 投票后不能修改投票选项
- [ ] 投票进度正确更新（0/2 → 1/2 → 2/2）
- [ ] 已投票人员状态正确显示（通过/拒绝/弃权）
- [ ] 投票完成后显示"投票完成"标签

## 常见问题

### Q: 投票按钮在哪里？
A: 在会议详情页，点击需求后，右侧应该显示投票面板。

### Q: 为什么我看不到投票选项？
A: 可能原因：
1. 当前用户不在投票人员列表中
2. 会议状态不是"in_progress"
3. 没有选择需求

### Q: 投票后可以修改吗？
A: 不可以。投票后选项会变灰，无法修改。

### Q: 如何重置测试？
A: 使用上面的API命令清空投票人员列表，或删除投票记录。

## 测试反馈

测试完成后，请反馈：
1. ✅ 成功的场景
2. ❌ 失败的场景
3. ⚠️ 不符合预期的行为
4. 💡 改进建议

根据反馈我会继续优化功能！
