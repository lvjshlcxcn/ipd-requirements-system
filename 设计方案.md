# 电力行业系统集成商需求管理系统设计方案

## 一、架构概述

### 1.1 系统定位
面向电力行业系统集成商的B2B需求管理系统，支持5-20人中型团队的多项目管理。

### 1.2 架构设计
采用前后端分离的Web应用架构：
- **前端**：React + TypeScript 提供现代化交互界面
- **后端**：FastAPI + SQLAlchemy 构建RESTful API
- **数据层**：PostgreSQL 作为主数据库，确保数据完整性和可追溯性

### 1.3 核心设计原则
1. **流程完整性**：实现需求从客户提出到最终交付的完整生命周期管理
2. **可追溯性**：每个需求变更和流转都有完整的历史记录，支持全链路追踪
3. **合规性基础**：预留行业合规字段和文档模板接口，支持电力行业特定要求
4. **灵活性**：配置化的流程引擎，适应不同项目的个性化需求

---

## 二、核心功能模块

### 2.1 需求收集与分析模块
- 支持多渠道需求录入（邮件导入、在线表单、API对接）
- **需求来源分类**：外部需求（客户提出）、内部需求（团队优化、技术改进）
- 需求分类标签管理（功能需求/非功能需求/变更需求/缺陷）
- **APPEALS模型评估**：对需求进行8维度分类和评分
  - Availability（可获得性）
  - Packaging（包装）
  - Performance（性能）
  - Ease of use（易用性）
  - Assurance（保证）
  - Life cycle cost（生命周期成本）
  - Social acceptance（社会接受度）
- **需求优先级评估**：MoSCoW方法（Must/Should/Could/Won't）结合APPEALS评分
- 需求关联管理（关联客户、项目、合同）
- 附件支持（需求文档、图纸、会议纪要）

### 2.2 需求分配与跟踪模块
- 基于项目/团队的需求分配（支持批量分配）
- 需求状态流转（待分析→已分配→开发中→测试中→已完成→已交付）
- 甘特图看板展示需求进度
- 工作量记录与统计
- 逾期提醒和风险预警

### 2.3 需求变更管理模块
- 变更申请流程（申请→评估→审批→实施→验证）
- 变更影响分析（关联需求、工作量、成本影响）
- 变更版本管理（保留历史版本，支持版本对比）
- 变更审批流（可配置多级审批）
- 变更通知机制（邮件/站内消息）

### 2.4 需求验证与交付模块
- 验证计划制定（测试用例、验证标准）
- 验证执行记录（测试结果、问题记录）
- 客户确认流程（验收签字、反馈记录）
- 交付文档生成（需求规格书、测试报告、交付清单）
- 交付状态跟踪（部分交付/全部交付/已验收）

---

## 三、系统特色功能（电力系统集成场景优化）

### 3.1 项目关联管理
- 需求与电力项目（如变电站、配网改造等）强关联
- 支持项目多维度视图

### 3.2 合同追溯
- 需求可追溯至具体合同条款
- 支持合同文档挂载

### 3.3 阶段里程碑
- 支持电力项目典型阶段（初设/施工图/调试/试运行/验收）
- 里程碑完成情况跟踪

### 3.4 合规性检查项
- 可配置的检查清单
- 确保符合行业规范要求

### 3.5 多维度统计
- 按客户/项目/团队/时间维度生成报表
- 支持数据导出

### 3.6 权限管理
- 多角色权限控制（项目经理/需求分析/开发/测试/客户）
- 细粒度的功能权限控制

---

## 四、数据库结构

### 4.1 核心数据表（8张主要表）

#### 1. projects（项目表）
```sql
- id: 主键
- name: 项目名称
- customer: 客户名称
- contract_no: 合同编号
- phase: 项目阶段
- start_date: 开始日期
- end_date: 预计结束日期
- actual_end_date: 实际结束日期
- status: 状态
- description: 项目描述
- created_at: 创建时间
- updated_at: 更新时间
```

#### 2. requirements（需求主表）
```sql
- id: 主键
- title: 需求标题
- description: 需求描述
- source: 来源（外部/内部）
- category: 分类（功能/非功能/变更/缺陷）
- priority: 优先级（Must/Should/Could/Won't）
- status: 状态
- project_id: 关联项目
- created_by: 创建人
- assigned_to: 分配给谁
- created_at: 创建时间
- updated_at: 更新时间
```

#### 3. requirement_appeals（APPEALS评估表）
```sql
- id: 主键
- requirement_id: 关联需求ID
- availability_score: 可获得性评分（1-5）
- packaging_score: 包装评分（1-5）
- performance_score: 性能评分（1-5）
- ease_of_use_score: 易用性评分（1-5）
- assurance_score: 保证评分（1-5）
- lifecycle_cost_score: 生命周期成本评分（1-5）
- social_acceptance_score: 社会接受度评分（1-5）
- total_score: 总分
- evaluated_by: 评估人
- evaluated_at: 评估时间
- notes: 评估说明
```

#### 4. requirement_changes（需求变更表）
```sql
- id: 主键
- requirement_id: 关联需求
- change_type: 变更类型
- reason: 变更原因
- impact_analysis: 影响分析
- cost_impact: 成本影响
- effort_impact: 工作量影响
- approval_status: 审批状态
- approved_by: 审批人
- approved_at: 审批时间
- version: 版本号
- created_by: 创建人
- created_at: 创建时间
```

#### 5. requirement_assignments（需求分配表）
```sql
- id: 主键
- requirement_id: 需求ID
- assigned_to: 分配给谁
- assigned_by: 分配人
- assigned_at: 分配时间
- start_date: 开始时间
- estimated_end_date: 预计完成时间
- actual_end_date: 实际完成时间
- effort_hours: 工作量（小时）
- actual_hours: 实际工作量（小时）
- notes: 备注
```

#### 6. requirements_verification（需求验证表）
```sql
- id: 主键
- requirement_id: 需求ID
- verification_plan: 验证计划
- test_cases: 测试用例
- execution_result: 执行结果
- issues_found: 发现的问题
- verification_status: 验证状态
- verified_by: 验证人
- verified_at: 验证时间
- customer_approved: 客户是否确认
- customer_feedback: 客户反馈
```

#### 7. workflows（工作流历史表）
```sql
- id: 主键
- entity_type: 实体类型（requirement/change/verification）
- entity_id: 实体ID
- action: 操作类型
- from_status: 原状态
- to_status: 新状态
- actor: 操作人
- action_at: 操作时间
- comments: 备注
```

#### 8. attachments（附件表）
```sql
- id: 主键
- filename: 文件名
- file_path: 存储路径
- file_type: 文件类型
- file_size: 文件大小
- entity_type: 关联实体类型
- entity_id: 关联实体ID
- uploaded_by: 上传人
- uploaded_at: 上传时间
```

---

## 五、技术选型

### 5.1 前端技术栈
- **框架**：React 18
- **语言**：TypeScript 5+
- **构建**：Vite 5
- **UI组件库**：Ant Design 5（企业级）
- **服务端状态**：TanStack Query
- **图表**：Recharts
- **路由**：React Router v6

### 5.2 后端技术栈
- **框架**：FastAPI
- **ORM**：SQLAlchemy 2.0
- **数据库迁移**：Alembic
- **认证**：Python-jose（JWT）
- **API文档**：Swagger UI / ReDoc（自动生成）

### 5.3 数据库
- **主数据库**：PostgreSQL 15
- **备选方案**：SQLite（轻量级，无需额外服务）

---

## 六、部署方案（离线私有化部署）

### 6.1 部署要求
- **环境**：完全离线部署，受电网安全管控
- **部署方式**：私有化部署，不支持云服务
- **操作系统**：Linux/Windows Server

### 6.2 部署方案
- **离线安装包**：提供完整的离线安装脚本和依赖包
- **原生部署**：
  - 前端：打包为静态文件（Nginx/Apache提供）
  - 后端：通过 uvicorn/gunicorn 直接运行
- **数据库选择**：
  - PostgreSQL：标准部署
  - SQLite：无需额外数据库服务，适合小规模快速部署
- **内网隔离部署**：完全脱离互联网运行，所有依赖本地化

### 6.3 交付物
- 源代码包
- 离线依赖包（Python依赖、Node依赖）
- 安装部署文档
- 一键初始化脚本（环境配置、数据库初始化、服务启动）
- 数据库备份/恢复脚本

---

## 七、开发阶段规划

### 第一阶段：基础框架
- 用户认证系统
- 项目 CRUD
- 需求 CRUD

### 第二阶段：核心流程
- 需求分配
- 状态流转
- APPEALS 评估

### 第三阶段：变更管理
- 变更申请
- 审批流
- 版本管理

### 第四阶段：验证交付
- 验证计划
- 执行记录
- 文档生成

### 第五阶段：统计报表
- 多维度统计
- 可视化看板

---

## 八、非功能性需求

### 8.1 安全性
- 支持离线部署，数据不出内网
- JWT认证 + 角色权限控制
- 敏感操作日志记录

### 8.2 可用性
- 响应时间 < 2秒
- 支持5-20人并发操作
- 浏览器兼容：Chrome/Firefox/Edge 最新版本

### 8.3 可维护性
- 清晰的代码结构和注释
- 完善的API文档
- 数据库备份/恢复机制

---

## 九、总结

本设计方案为电力行业系统集成商提供了一套完整的B2B需求管理系统解决方案，核心特点：

1. **流程完整性**：覆盖需求全生命周期管理
2. **可追溯性**：完整的历史记录和版本管理
3. **行业适配**：电力项目阶段、合同追溯、合规检查
4. **离线部署**：满足电网安全管控要求
5. **私有化部署**：不依赖云服务，数据自主可控

系统将帮助5-20人规模的中型系统集成商团队规范化管理需求，提升项目交付质量，降低变更风险。
